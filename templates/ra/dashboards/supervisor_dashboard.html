{% extends "base-wide.html" %}
{% load static %}
{% load form_display %}

{% block title %}RA Request Dashboard{% endblock %}
{% block h1 %}RA Request Dashboard{% endblock %}

{% block headextra %}
<script nonce="{{ CSP_NONCE }}">
$(document).ready(function() {
    $('#reqs').dataTable( {
    'bPaginate': false,
    'bInfo': true,
    'bFilter': true,
    'bLengthChange': false,
    "bJQueryUI": true,
    'aaSorting': [[1, 'asc']],
    } );
    $('#reqs_complete').dataTable( {
    'bPaginate': false,
    'bInfo': true,
    'bFilter': true,
    'bLengthChange': false,
    "bJQueryUI": true,
    'aaSorting': [[1, 'asc']],
    } );
} );
</script>
{% endblock %}

{% block subbreadcrumbs %}
<li>Dashboard</li>
{% endblock %}

{% block content %}
</i>
<p>This page will display any RA requests/appointments that you have created or are a supervisor for.<p>
<p>If you have the correct permissions, you may also create/reappoint new requests here.</p>

<h3>Actions</h3>
<p>
  <li><a href="{% url "ra:new_request" %}">New RA Request</a></li>
</p>

<h3>Open Requests</h3>
<div class="datatable_container">
  <table id="reqs" class="display">
    <thead>
      <tr>
        <th scope="col">Appointee</th>
        <th scope="col">Supervisor</th>
        <th scope="col">Hiring Category</th>
        <th scope="col">Start Date</th>
        <th scope="col">End Date</th>
        <th scope="col">Created At</th>
        <th scope="col">Author</th>
      </tr>
    </thead>
    <tbody>
      {% for req in reqs %}
        <tr>
          <td><a href="{% url "ra:view_request" ra_slug=req.slug %}">
            {{ req.get_name }}
          </a></td>
          <td>{{ req.supervisor }}</td>
          <td>{{ req.hiring_category }}</td>
          <td><span class="sort">{{ req.start_date.isoformat }}</span>{{ req.start_date }}</td>
          <td><span class="sort">{{ req.end_date.isoformat }}</span>{{ req.end_date }}</td>
          <td><span class="sort">{{ req.created_at.isoformat }}</span>{{ req.created_at }}</td>
          <td>{{ req.author }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<h3>Completed Requests</h3>
<div class="datatable_container">
  <table id="reqs_complete" class="display">
    <thead>
      <tr>
        <th scope="col">Appointee</th>
        <th scope="col">Supervisor</th>
        <th scope="col">Hiring Category</th>
        <th scope="col">Start Date</th>
        <th scope="col">End Date</th>
        <th scope="col">Created At</th>
        <th scope="col">Author</th>
        <th scope="col">Total Pay</th>
      </tr>
    </thead>
    <tbody>
      {% for req in reqs_complete %}
        <tr>
          <td><a href="{% url "ra:view_request" ra_slug=req.slug %}">
            {{ req.get_name }}
          </a></td>
          <td>{{ req.supervisor }}</td>
          <td>{{ req.hiring_category }}</td>
          <td><span class="sort">{{ req.start_date.isoformat }}</span>{{ req.start_date }}</td>
          <td><span class="sort">{{ req.end_date.isoformat }}</span>{{ req.end_date }}</td>
          <td><span class="sort">{{ req.created_at.isoformat }}</span>{{ req.created_at }}</td>
          <td>{{ req.author }}</td>
          <td>{{ req.total_pay }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
